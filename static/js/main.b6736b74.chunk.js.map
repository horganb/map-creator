{"version":3,"sources":["Home.js","usePersistedState.js","Editor.js","Viewer.js","App.js","reportWebVitals.js","index.js"],"names":["mapsUrl","initialMapData","name","image","url","pins","Home","useState","maps","setMaps","history","useHistory","useEffect","axios","get","then","data","catch","e","console","error","goToMap","mapId","push","getPath","mapLinks","map","_id","Button","className","variant","onClick","color","post","usePersistedState","defaultValue","path","value","setValue","useParams","updateMap","updates","method","UpdateMethods","SET","updateObject","put","newValue","persist","UNSET","Editor","imageURL","setImageURL","mapName","setMapName","setPins","selectedPin","setSelectedPin","loading","setLoading","setError","setImage","pinRefs","useRef","displayData","TextField","label","onChange","target","Object","keys","pinId","pinData","x","y","isSelected","Fragment","style","left","top","onPinClick","onContextMenu","preventDefault","otherPins","onPinRightClick","ref","el","current","pin","onClose","show","setPin","newData","anchorEl","src","rect","getBoundingClientRect","window","scrollX","scrollY","getPosition","relativeX","pageX","relativeY","pageY","id","generateId","addPin","width","height","alt","imageEl","CircularProgress","PinCard","title","description","Popper","open","transition","TransitionProps","Fade","timeout","Card","CardHeader","action","IconButton","CardContent","multiline","rows","Viewer","prefix","App","exact","to","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.b6736b74.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { Button } from '@material-ui/core';\r\nimport { getPath } from './App';\r\n\r\n// export const mapsUrl = 'http://localhost:3000';\r\n// export const mapsUrl = 'http://192.168.37.94:3000';\r\nexport const mapsUrl = 'https://map-creator-backend.herokuapp.com';\r\n\r\nconst initialMapData = {\r\n  name: 'Untitled Map',\r\n  image: {\r\n    url: 'https://cdn.pixabay.com/photo/2015/04/23/22/00/tree-736885__480.jpg',\r\n  },\r\n  pins: {},\r\n};\r\n\r\nconst Home = () => {\r\n  const [maps, setMaps] = useState([]);\r\n  const history = useHistory();\r\n\r\n  // On initial load, load the list of maps.\r\n  useEffect(() => {\r\n    axios\r\n      .get(`${mapsUrl}/maps`)\r\n      .then(({ data }) => {\r\n        setMaps(data);\r\n      })\r\n      .catch(e => {\r\n        console.error(e);\r\n      });\r\n  }, []);\r\n\r\n  const goToMap = mapId => {\r\n    history.push(getPath(`/maps/${mapId}`));\r\n  };\r\n\r\n  const mapLinks = maps.map(({ name, _id }) => {\r\n    return (\r\n      <Button\r\n        className=\"map-button\"\r\n        key={_id}\r\n        variant=\"contained\"\r\n        onClick={() => goToMap(_id)}\r\n      >\r\n        {name}\r\n      </Button>\r\n    );\r\n  });\r\n\r\n  const newMap = () => {\r\n    axios\r\n      .post(`${mapsUrl}/maps`, initialMapData)\r\n      .then(({ data }) => {\r\n        goToMap(data);\r\n      })\r\n      .catch(e => {\r\n        console.error(e);\r\n      });\r\n  };\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        <Button\r\n          className=\"map-button\"\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          onClick={newMap}\r\n        >\r\n          Create New\r\n        </Button>\r\n        {mapLinks}\r\n      </header>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n","import { useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { mapsUrl } from './Home';\r\n\r\nconst usePersistedState = (defaultValue, path) => {\r\n  const [value, setValue] = useState(defaultValue);\r\n  const { mapId } = useParams();\r\n\r\n  const updateMap = (updates, method = UpdateMethods.SET) => {\r\n    const updateObject = {\r\n      [method]: updates,\r\n    };\r\n    axios\r\n      .put(`${mapsUrl}/maps/${mapId}`, updateObject)\r\n      .then(() => {})\r\n      .catch(e => {\r\n        console.error(e);\r\n      });\r\n  };\r\n\r\n  const updateValue = (newValue, persist = true) => {\r\n    setValue(newValue);\r\n    if (persist) {\r\n      updateMap({\r\n        [path]: newValue,\r\n      });\r\n    }\r\n  };\r\n\r\n  return [value, updateValue];\r\n};\r\n\r\nexport default usePersistedState;\r\n\r\nconst UpdateMethods = {\r\n  SET: '$set',\r\n  UNSET: '$unset',\r\n};\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { useParams, useHistory } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { mapsUrl } from './Home';\r\nimport {\r\n  Button,\r\n  TextField,\r\n  CircularProgress,\r\n  Card,\r\n  CardHeader,\r\n  CardContent,\r\n  IconButton,\r\n  Popper,\r\n  Fade,\r\n} from '@material-ui/core';\r\nimport RoomIcon from '@material-ui/icons/Room';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport { v4 as generateId } from 'uuid';\r\nimport usePersistedState from './usePersistedState';\r\nimport { getPath } from './App';\r\n\r\nconst Editor = () => {\r\n  const { mapId } = useParams();\r\n  const history = useHistory();\r\n\r\n  const [imageURL, setImageURL] = usePersistedState('', 'image.url');\r\n  const [mapName, setMapName] = usePersistedState('', 'name');\r\n  const [pins, setPins] = usePersistedState({}, 'pins');\r\n\r\n  const [selectedPin, setSelectedPin] = useState();\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(false);\r\n  const [image, setImage] = useState();\r\n\r\n  const pinRefs = useRef({});\r\n\r\n  // When map is changed, load in the data\r\n  useEffect(() => {\r\n    if (mapId) {\r\n      setLoading(true);\r\n      axios\r\n        .get(`${mapsUrl}/maps/${mapId}`)\r\n        .then(({ data }) => {\r\n          setError(false);\r\n          const { name, image, pins } = data;\r\n          setImageURL(image.url, false);\r\n          setMapName(name, false);\r\n          setPins(pins, false);\r\n        })\r\n        .catch(e => {\r\n          console.error(e);\r\n          setError(true);\r\n        })\r\n        .then(() => {\r\n          setLoading(false);\r\n        });\r\n    }\r\n  }, [mapId]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const goHome = () => {\r\n    history.push(getPath('/'));\r\n  };\r\n\r\n  const getPosition = el => {\r\n    const rect = el.getBoundingClientRect();\r\n    return {\r\n      left: rect.left + window.scrollX,\r\n      top: rect.top + window.scrollY,\r\n    };\r\n  };\r\n\r\n  const addPin = (x, y) => {\r\n    const id = generateId();\r\n    setPins({\r\n      ...pins,\r\n      [id]: { x, y },\r\n    });\r\n  };\r\n\r\n  const onImageClick = e => {\r\n    const { left, top } = getPosition(image);\r\n    const relativeX = e.pageX - left;\r\n    const relativeY = e.pageY - top;\r\n    const xFraction = relativeX / image.width;\r\n    const yFraction = relativeY / image.height;\r\n    addPin(xFraction, yFraction);\r\n  };\r\n\r\n  const onPinClick = pinId => {\r\n    setSelectedPin(pinId === selectedPin ? null : pinId);\r\n  };\r\n\r\n  const onPinRightClick = (pinId, e) => {\r\n    e.preventDefault();\r\n    const { [pinId]: _, ...otherPins } = pins;\r\n    setPins(otherPins);\r\n    setSelectedPin();\r\n  };\r\n\r\n  const renderPins = () =>\r\n    image &&\r\n    Object.keys(pins).map(pinId => {\r\n      const pinData = pins[pinId];\r\n      if (!pinData) return undefined;\r\n      const { x, y } = pinData;\r\n      const isSelected = selectedPin === pinId;\r\n\r\n      const refCallback = el => {\r\n        if (pinRefs?.current) {\r\n          pinRefs.current[pinId] = el;\r\n        }\r\n      };\r\n\r\n      return (\r\n        <React.Fragment key={pinId}>\r\n          <RoomIcon\r\n            className=\"pin\"\r\n            style={{\r\n              left: `${x * 100}%`,\r\n              top: `${y * 100}%`,\r\n              color: isSelected ? 'yellow' : 'red',\r\n            }}\r\n            onClick={() => onPinClick(pinId)}\r\n            onContextMenu={e => onPinRightClick(pinId, e)}\r\n            ref={refCallback}\r\n          />\r\n          <PinCard\r\n            pin={pinData}\r\n            onClose={() => setSelectedPin()}\r\n            show={isSelected}\r\n            setPin={newData => {\r\n              setPins({\r\n                ...pins,\r\n                [pinId]: newData,\r\n              });\r\n            }}\r\n            anchorEl={pinRefs?.current?.[pinId]}\r\n          />\r\n        </React.Fragment>\r\n      );\r\n    });\r\n\r\n  const imageCallback = imageEl => {\r\n    if (imageEl && imageEl !== image) {\r\n      setImage(imageEl);\r\n    }\r\n  };\r\n\r\n  const displayData = !loading && !error;\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        <div className=\"metadata-section\">\r\n          <Button\r\n            className=\"return-home\"\r\n            variant=\"contained\"\r\n            color=\"secondary\"\r\n            onClick={goHome}\r\n          >\r\n            Back to Home\r\n          </Button>\r\n          {displayData && (\r\n            <>\r\n              <br />\r\n              <TextField\r\n                className=\"map-name\"\r\n                label=\"Map Name\"\r\n                value={mapName}\r\n                onChange={e => setMapName(e.target.value)}\r\n                variant=\"outlined\"\r\n              />\r\n              <br />\r\n              <TextField\r\n                className=\"image-url\"\r\n                label=\"Image URL\"\r\n                value={imageURL}\r\n                onChange={e => setImageURL(e.target.value)}\r\n                variant=\"filled\"\r\n              />\r\n            </>\r\n          )}\r\n        </div>\r\n        {displayData && (\r\n          <div className=\"image-container\">\r\n            {renderPins()}\r\n            <img\r\n              src={imageURL}\r\n              onClick={onImageClick}\r\n              className=\"App-logo\"\r\n              alt=\"logo\"\r\n              ref={imageCallback}\r\n            />\r\n            {/* {renderPinCard()} */}\r\n          </div>\r\n        )}\r\n        {loading && <CircularProgress />}\r\n        {error && <p>Could not load the requested map!</p>}\r\n      </header>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Editor;\r\n\r\nconst PinCard = ({ x, y, pin, setPin, onClose, show, anchorEl }) => {\r\n  const { title, description, color } = pin;\r\n\r\n  return (\r\n    <Popper open={show} anchorEl={anchorEl} transition>\r\n      {({ TransitionProps }) => (\r\n        <Fade {...TransitionProps} timeout={150}>\r\n          <Card className=\"description-card\">\r\n            <CardHeader\r\n              title={\r\n                <TextField\r\n                  className=\"title-field\"\r\n                  label=\"Item Title\"\r\n                  value={title}\r\n                  onChange={e => setPin({ ...pin, title: e.target.value })}\r\n                />\r\n              }\r\n              action={\r\n                <IconButton onClick={onClose}>\r\n                  <CloseIcon />\r\n                </IconButton>\r\n              }\r\n            />\r\n            <CardContent>\r\n              <TextField\r\n                className=\"body-field\"\r\n                label=\"Item Description\"\r\n                value={description}\r\n                onChange={e => setPin({ ...pin, description: e.target.value })}\r\n                variant=\"outlined\"\r\n                multiline\r\n                rows={3}\r\n              />\r\n            </CardContent>\r\n          </Card>\r\n        </Fade>\r\n      )}\r\n    </Popper>\r\n  );\r\n};\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { mapsUrl } from './Home';\r\nimport {\r\n  CircularProgress,\r\n  Card,\r\n  CardHeader,\r\n  CardContent,\r\n  IconButton,\r\n  Popper,\r\n  Fade,\r\n} from '@material-ui/core';\r\nimport RoomIcon from '@material-ui/icons/Room';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport usePersistedState from './usePersistedState';\r\n\r\nconst Viewer = () => {\r\n  const { mapId } = useParams();\r\n\r\n  const [imageURL, setImageURL] = usePersistedState('', 'image.url');\r\n  const [mapName, setMapName] = usePersistedState('', 'name');\r\n  const [pins, setPins] = usePersistedState({}, 'pins');\r\n\r\n  const [selectedPin, setSelectedPin] = useState();\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(false);\r\n  const [image, setImage] = useState();\r\n\r\n  const pinRefs = useRef({});\r\n\r\n  // When map is changed, load in the data\r\n  useEffect(() => {\r\n    if (mapId) {\r\n      setLoading(true);\r\n      axios\r\n        .get(`${mapsUrl}/maps/${mapId}`)\r\n        .then(({ data }) => {\r\n          setError(false);\r\n          const { name, image, pins } = data;\r\n          setImageURL(image.url, false);\r\n          setMapName(name, false);\r\n          setPins(pins, false);\r\n        })\r\n        .catch(e => {\r\n          console.error(e);\r\n          setError(true);\r\n        })\r\n        .then(() => {\r\n          setLoading(false);\r\n        });\r\n    }\r\n  }, [mapId]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const onPinClick = pinId => {\r\n    setSelectedPin(pinId === selectedPin ? null : pinId);\r\n  };\r\n\r\n  const onPinRightClick = (pinId, e) => {\r\n    e.preventDefault();\r\n    const { [pinId]: _, ...otherPins } = pins;\r\n    setPins(otherPins);\r\n    setSelectedPin();\r\n  };\r\n\r\n  const renderPins = () =>\r\n    image &&\r\n    Object.keys(pins).map(pinId => {\r\n      const pinData = pins[pinId];\r\n      if (!pinData) return undefined;\r\n      const { x, y } = pinData;\r\n      const isSelected = selectedPin === pinId;\r\n\r\n      const refCallback = el => {\r\n        if (pinRefs?.current) {\r\n          pinRefs.current[pinId] = el;\r\n        }\r\n      };\r\n\r\n      return (\r\n        <React.Fragment key={pinId}>\r\n          <RoomIcon\r\n            className=\"pin\"\r\n            style={{\r\n              left: `${x * 100}%`,\r\n              top: `${y * 100}%`,\r\n              color: isSelected ? 'yellow' : 'red',\r\n            }}\r\n            onClick={() => onPinClick(pinId)}\r\n            onContextMenu={e => onPinRightClick(pinId, e)}\r\n            ref={refCallback}\r\n          />\r\n          <PinCard\r\n            pin={pinData}\r\n            onClose={() => setSelectedPin()}\r\n            show={isSelected}\r\n            setPin={newData => {\r\n              setPins({\r\n                ...pins,\r\n                [pinId]: newData,\r\n              });\r\n            }}\r\n            anchorEl={pinRefs?.current?.[pinId]}\r\n          />\r\n        </React.Fragment>\r\n      );\r\n    });\r\n\r\n  const imageCallback = imageEl => {\r\n    if (imageEl && imageEl !== image) {\r\n      setImage(imageEl);\r\n    }\r\n  };\r\n\r\n  const displayData = !loading && !error;\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        <div className=\"metadata-section\">{displayData && mapName}</div>\r\n        {displayData && (\r\n          <div className=\"image-container\">\r\n            {renderPins()}\r\n            <img\r\n              src={imageURL}\r\n              className=\"App-logo\"\r\n              alt=\"logo\"\r\n              ref={imageCallback}\r\n            />\r\n          </div>\r\n        )}\r\n        {loading && <CircularProgress />}\r\n        {error && <p>Could not load the requested map!</p>}\r\n      </header>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Viewer;\r\n\r\nconst PinCard = ({ x, y, pin, setPin, onClose, show, anchorEl }) => {\r\n  const { title, description, color } = pin;\r\n\r\n  return (\r\n    <Popper open={show} anchorEl={anchorEl} transition>\r\n      {({ TransitionProps }) => (\r\n        <Fade {...TransitionProps} timeout={150}>\r\n          <Card className=\"description-card\">\r\n            <CardHeader\r\n              title={title}\r\n              action={\r\n                <IconButton onClick={onClose}>\r\n                  <CloseIcon />\r\n                </IconButton>\r\n              }\r\n            />\r\n            <CardContent>{description}</CardContent>\r\n          </Card>\r\n        </Fade>\r\n      )}\r\n    </Popper>\r\n  );\r\n};\r\n","import './App.css';\nimport React from 'react';\nimport {\n  BrowserRouter as Router,\n  Route,\n  Redirect,\n  Switch,\n} from 'react-router-dom';\nimport Editor from './Editor';\nimport Home from './Home';\nimport Viewer from './Viewer';\n\nexport const getPath = path => `${prefix}${path}`;\n\nconst prefix = '/map-creator';\n\nconst App = () => {\n  return (\n    <Router>\n      <Switch>\n        <Route exact path={getPath('/')}>\n          <Home />\n        </Route>\n        <Route path={getPath('/maps/:mapId/view')}>\n          <Viewer />\n        </Route>\n        <Route path={getPath('/maps/:mapId')}>\n          <Editor />\n        </Route>\n        <Redirect to={getPath('/')} />\n      </Switch>\n    </Router>\n  );\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}
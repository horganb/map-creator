{"version":3,"sources":["Home.js","usePersistedState.js","Editor.js","Viewer.js","App.js","reportWebVitals.js","index.js"],"names":["mapsUrl","initialMapData","name","image","url","pins","Home","useState","maps","setMaps","history","useHistory","useEffect","axios","get","then","data","catch","e","console","error","goToMap","mapId","push","mapLinks","map","_id","Button","className","variant","onClick","color","post","usePersistedState","defaultValue","path","value","setValue","useParams","updateMap","updates","method","UpdateMethods","SET","updateObject","put","newValue","persist","UNSET","getPosition","el","rect","getBoundingClientRect","left","window","scrollX","top","scrollY","Editor","imageURL","setImageURL","mapName","setMapName","setPins","selectedPin","setSelectedPin","loading","setLoading","setError","setImage","setScreenDimensions","pinRefs","useRef","handleResize","height","innerHeight","width","innerWidth","addEventListener","removeEventListener","displayData","pinData","TextField","label","onChange","target","CircularProgress","Object","keys","pinId","x","y","isSelected","style","transform","onPinClick","onContextMenu","preventDefault","otherPins","onPinRightClick","ref","current","src","relativeX","pageX","relativeY","pageY","xFraction","yFraction","log","id","generateId","addPin","alt","imageEl","pin","onClose","setPin","newData","PinCard","title","description","Card","CardHeader","action","IconButton","CardContent","multiline","rows","Viewer","setTimeout","pageButtons","ToggleButton","ToggleButtonGroup","exclusive","display","marginBottom","Fragment","opacity","App","basename","exact","to","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.3db023c1.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { Button } from '@material-ui/core';\r\n\r\n// export const mapsUrl = 'http://localhost:3000';\r\n// export const mapsUrl = 'http://192.168.37.94:3000';\r\nexport const mapsUrl = 'https://map-creator-backend.herokuapp.com';\r\n\r\nconst initialMapData = {\r\n  name: 'Untitled Map',\r\n  image: {\r\n    url: 'https://cdn.pixabay.com/photo/2015/04/23/22/00/tree-736885__480.jpg',\r\n  },\r\n  pins: {},\r\n};\r\n\r\nconst Home = () => {\r\n  const [maps, setMaps] = useState([]);\r\n  const history = useHistory();\r\n\r\n  // On initial load, load the list of maps.\r\n  useEffect(() => {\r\n    axios\r\n      .get(`${mapsUrl}/maps`)\r\n      .then(({ data }) => {\r\n        setMaps(data);\r\n      })\r\n      .catch(e => {\r\n        console.error(e);\r\n      });\r\n  }, []);\r\n\r\n  const goToMap = mapId => {\r\n    history.push(`/maps/${mapId}`);\r\n  };\r\n\r\n  const mapLinks = maps.map(({ name, _id }) => {\r\n    return (\r\n      <Button\r\n        className=\"map-button\"\r\n        key={_id}\r\n        variant=\"contained\"\r\n        onClick={() => goToMap(_id)}\r\n      >\r\n        {name}\r\n      </Button>\r\n    );\r\n  });\r\n\r\n  const newMap = () => {\r\n    axios\r\n      .post(`${mapsUrl}/maps`, initialMapData)\r\n      .then(({ data }) => {\r\n        goToMap(data);\r\n      })\r\n      .catch(e => {\r\n        console.error(e);\r\n      });\r\n  };\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        <Button\r\n          className=\"map-button\"\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          onClick={newMap}\r\n        >\r\n          Create New\r\n        </Button>\r\n        {mapLinks}\r\n      </header>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n","import { useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { mapsUrl } from './Home';\r\n\r\nconst usePersistedState = (defaultValue, path) => {\r\n  const [value, setValue] = useState(defaultValue);\r\n  const { mapId } = useParams();\r\n\r\n  const updateMap = (updates, method = UpdateMethods.SET) => {\r\n    const updateObject = {\r\n      [method]: updates,\r\n    };\r\n    axios\r\n      .put(`${mapsUrl}/maps/${mapId}`, updateObject)\r\n      .then(() => {})\r\n      .catch(e => {\r\n        console.error(e);\r\n      });\r\n  };\r\n\r\n  const updateValue = (newValue, persist = true) => {\r\n    setValue(newValue);\r\n    if (persist) {\r\n      updateMap({\r\n        [path]: newValue,\r\n      });\r\n    }\r\n  };\r\n\r\n  return [value, updateValue];\r\n};\r\n\r\nexport default usePersistedState;\r\n\r\nconst UpdateMethods = {\r\n  SET: '$set',\r\n  UNSET: '$unset',\r\n};\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { useParams, useHistory } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { mapsUrl } from './Home';\r\nimport {\r\n  Button,\r\n  TextField,\r\n  CircularProgress,\r\n  Card,\r\n  CardHeader,\r\n  CardContent,\r\n  IconButton,\r\n  Popper,\r\n  Fade,\r\n} from '@material-ui/core';\r\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport { v4 as generateId } from 'uuid';\r\nimport usePersistedState from './usePersistedState';\r\n\r\nexport const getPosition = el => {\r\n  const rect = el.getBoundingClientRect();\r\n  // console.log('top', rect.top, 'scroll', window.scrollY);\r\n  return {\r\n    left: rect.left + window.scrollX,\r\n    top: rect.top + window.scrollY,\r\n  };\r\n};\r\n\r\nconst Editor = () => {\r\n  const { mapId } = useParams();\r\n  const history = useHistory();\r\n\r\n  const [imageURL, setImageURL] = usePersistedState('', 'image.url');\r\n  const [mapName, setMapName] = usePersistedState('', 'name');\r\n  const [pins, setPins] = usePersistedState({}, 'pins');\r\n\r\n  const [selectedPin, setSelectedPin] = useState();\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(false);\r\n  const [image, setImage] = useState();\r\n  const [screenDimensions, setScreenDimensions] = useState();\r\n\r\n  const pinRefs = useRef({});\r\n\r\n  // When map is changed, load in the data\r\n  useEffect(() => {\r\n    if (mapId) {\r\n      setLoading(true);\r\n      axios\r\n        .get(`${mapsUrl}/maps/${mapId}`)\r\n        .then(({ data }) => {\r\n          setError(false);\r\n          const { name, image, pins } = data;\r\n          setImageURL(image.url, false);\r\n          setMapName(name, false);\r\n          setPins(pins, false);\r\n        })\r\n        .catch(e => {\r\n          console.error(e);\r\n          setError(true);\r\n        })\r\n        .then(() => {\r\n          setLoading(false);\r\n        });\r\n    }\r\n  }, [mapId]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const goHome = () => {\r\n    history.push('/');\r\n  };\r\n\r\n  const addPin = (x, y) => {\r\n    const id = generateId();\r\n    setPins({\r\n      ...pins,\r\n      [id]: { x, y },\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    // if (!contentRef?.current) return;\r\n\r\n    // const content = contentRef?.current;\r\n\r\n    const handleResize = () => {\r\n      // console.log('setting to', content);\r\n      setScreenDimensions({\r\n        height: window.innerHeight,\r\n        width: window.innerWidth,\r\n      });\r\n    };\r\n\r\n    handleResize();\r\n\r\n    window.addEventListener('resize', handleResize);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', handleResize);\r\n    };\r\n  }, []);\r\n\r\n  const onImageClick = e => {\r\n    const { left, top } = getPosition(image);\r\n    const relativeX = e.pageX - left;\r\n    const relativeY = e.pageY - top;\r\n    // console.log(left, top);\r\n    const xFraction = relativeX / image.width;\r\n    const yFraction = relativeY / image.height;\r\n    console.log(e.pageY, top);\r\n    addPin(xFraction, yFraction);\r\n  };\r\n\r\n  const onPinClick = pinId => {\r\n    setSelectedPin(pinId === selectedPin ? null : pinId);\r\n  };\r\n\r\n  const onPinRightClick = (pinId, e) => {\r\n    e.preventDefault();\r\n    const { [pinId]: _, ...otherPins } = pins;\r\n    setPins(otherPins);\r\n    setSelectedPin();\r\n  };\r\n\r\n  const renderPins = () =>\r\n    image &&\r\n    Object.keys(pins).map(pinId => {\r\n      const pinData = pins[pinId];\r\n      if (!pinData) return undefined;\r\n      const { x, y } = pinData;\r\n      const isSelected = selectedPin === pinId;\r\n\r\n      const refCallback = el => {\r\n        if (pinRefs?.current) {\r\n          pinRefs.current[pinId] = el;\r\n        }\r\n      };\r\n      // console.log('put at', y);\r\n      const { left, top } = getPosition(image);\r\n      return (\r\n        <AddCircleIcon\r\n          className=\"pin\"\r\n          key={pinId}\r\n          style={{\r\n            left: `${left + x * image.width}px`,\r\n            top: `${top + y * image.height}px`,\r\n            color: isSelected ? 'rgb(61, 161, 143)' : 'rgb(37, 247, 209)',\r\n            transform: `translateX(-50%) translateY(-50%)${\r\n              isSelected ? 'scale(2)' : ''\r\n            }`,\r\n          }}\r\n          onClick={() => onPinClick(pinId)}\r\n          onContextMenu={e => onPinRightClick(pinId, e)}\r\n          ref={refCallback}\r\n        />\r\n      );\r\n    });\r\n\r\n  const imageCallback = imageEl => {\r\n    if (imageEl && imageEl !== image) {\r\n      setImage(imageEl);\r\n    }\r\n  };\r\n\r\n  const displayData = !loading && !error;\r\n\r\n  const pinData = pins[selectedPin];\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        <div className=\"header\">\r\n          <Button\r\n            className=\"return-home\"\r\n            variant=\"contained\"\r\n            color=\"secondary\"\r\n            onClick={goHome}\r\n          >\r\n            Back to Home\r\n          </Button>\r\n          {displayData && (\r\n            <>\r\n              <br />\r\n              <TextField\r\n                className=\"map-name\"\r\n                label=\"Map Name\"\r\n                value={mapName}\r\n                onChange={e => setMapName(e.target.value)}\r\n                variant=\"outlined\"\r\n              />\r\n              <br />\r\n              <TextField\r\n                className=\"image-url\"\r\n                label=\"Image URL\"\r\n                value={imageURL}\r\n                onChange={e => setImageURL(e.target.value)}\r\n                variant=\"filled\"\r\n              />\r\n            </>\r\n          )}\r\n        </div>\r\n        <div className=\"content\">\r\n          {loading && <CircularProgress />}\r\n          <div className=\"image-wrapper\">\r\n            {renderPins()}\r\n            <img\r\n              src={imageURL}\r\n              onClick={onImageClick}\r\n              className=\"App-logo\"\r\n              alt=\"logo\"\r\n              ref={imageCallback}\r\n            />\r\n          </div>\r\n        </div>\r\n        <div className=\"footer\">\r\n          {pinData && (\r\n            <PinCard\r\n              pin={pinData}\r\n              onClose={() => setSelectedPin()}\r\n              setPin={newData => {\r\n                setPins({\r\n                  ...pins,\r\n                  [selectedPin]: newData,\r\n                });\r\n              }}\r\n            />\r\n          )}\r\n        </div>\r\n        {error && <p>Could not load the requested map!</p>}\r\n      </header>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Editor;\r\n\r\nconst PinCard = ({ pin, setPin, onClose }) => {\r\n  const { title, description } = pin;\r\n\r\n  return (\r\n    <Card className=\"description-card\">\r\n      <CardHeader\r\n        title={\r\n          <TextField\r\n            className=\"title-field\"\r\n            label=\"Item Title\"\r\n            value={title}\r\n            onChange={e => setPin({ ...pin, title: e.target.value })}\r\n          />\r\n        }\r\n        action={\r\n          <IconButton onClick={onClose}>\r\n            <CloseIcon />\r\n          </IconButton>\r\n        }\r\n      />\r\n      <CardContent>\r\n        <TextField\r\n          className=\"body-field\"\r\n          label=\"Item Description\"\r\n          value={description}\r\n          onChange={e => setPin({ ...pin, description: e.target.value })}\r\n          variant=\"outlined\"\r\n          multiline\r\n          rows={3}\r\n        />\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { useHistory, useParams } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { mapsUrl } from './Home';\r\nimport {\r\n  CircularProgress,\r\n  Card,\r\n  CardHeader,\r\n  CardContent,\r\n  IconButton,\r\n} from '@material-ui/core';\r\nimport { ToggleButtonGroup, ToggleButton } from '@material-ui/lab';\r\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport usePersistedState from './usePersistedState';\r\nimport { getPosition } from './Editor';\r\n\r\nconst Viewer = () => {\r\n  const { mapId } = useParams();\r\n\r\n  const [imageURL, setImageURL] = usePersistedState('', 'image.url');\r\n  const [mapName, setMapName] = usePersistedState('', 'name');\r\n  const [pins, setPins] = usePersistedState({}, 'pins');\r\n\r\n  const [selectedPin, setSelectedPin] = useState();\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(false);\r\n  const [image, setImage] = useState();\r\n  const [screenDimensions, setScreenDimensions] = useState();\r\n\r\n  const pinRefs = useRef({});\r\n  const contentRef = useRef();\r\n\r\n  const [maps, setMaps] = useState([]);\r\n  const history = useHistory();\r\n\r\n  // On initial load, load the list of maps.\r\n  useEffect(() => {\r\n    axios\r\n      .get(`${mapsUrl}/maps`)\r\n      .then(({ data }) => {\r\n        setMaps(data);\r\n      })\r\n      .catch(e => {\r\n        console.error(e);\r\n      });\r\n  }, []);\r\n\r\n  // useEffect(() => {\r\n  //   if (!contentRef?.current) return;\r\n  //   const content = contentRef.current;\r\n  //   new ResizeObserver(() => {\r\n  //     console.log(content, content.offsetHeight, content.offsetWidth);\r\n  //     setScreenDimensions({\r\n  //       height: content.offsetHeight,\r\n  //       width: content.offsetWidth,\r\n  //     });\r\n  //   }).observe(contentRef.current);\r\n  //   // return () => obse  rver.unobserve();\r\n  // }, [!contentRef?.current]);\r\n\r\n  const handleResize = () => {\r\n    // console.log('setting to', content);\r\n    setScreenDimensions({\r\n      height: window.innerHeight,\r\n      width: window.innerWidth,\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    // if (!contentRef?.current) return;\r\n\r\n    // const content = contentRef?.current;\r\n\r\n    handleResize();\r\n\r\n    window.addEventListener('resize', handleResize);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', handleResize);\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    setTimeout(() => {\r\n      handleResize();\r\n    }, 100);\r\n  }, []);\r\n\r\n  // When map is changed, load in the data\r\n  useEffect(() => {\r\n    if (mapId) {\r\n      setLoading(true);\r\n      axios\r\n        .get(`${mapsUrl}/maps/${mapId}`)\r\n        .then(({ data }) => {\r\n          setError(false);\r\n          const { name, image, pins } = data;\r\n          setImageURL(image.url, false);\r\n          setMapName(name, false);\r\n          setPins(pins, false);\r\n        })\r\n        .catch(e => {\r\n          console.error(e);\r\n          setError(true);\r\n        })\r\n        .then(() => {\r\n          setLoading(false);\r\n        });\r\n    }\r\n  }, [mapId]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const onPinClick = pinId => {\r\n    setSelectedPin(pinId === selectedPin ? null : pinId);\r\n  };\r\n\r\n  const onPinRightClick = (pinId, e) => {\r\n    e.preventDefault();\r\n    const { [pinId]: _, ...otherPins } = pins;\r\n    setPins(otherPins);\r\n    setSelectedPin();\r\n  };\r\n\r\n  const renderPins = () =>\r\n    image &&\r\n    Object.keys(pins).map(pinId => {\r\n      const pinData = pins[pinId];\r\n      if (!pinData) return undefined;\r\n      const { x, y } = pinData;\r\n      const isSelected = selectedPin === pinId;\r\n\r\n      const refCallback = el => {\r\n        if (pinRefs?.current) {\r\n          pinRefs.current[pinId] = el;\r\n        }\r\n      };\r\n\r\n      const { left, top } = getPosition(image);\r\n\r\n      // console.log(image.left, x, image.width);\r\n      return (\r\n        <React.Fragment key={pinId}>\r\n          <AddCircleIcon\r\n            className=\"pin\"\r\n            style={{\r\n              left: `${left + x * image.width}px`,\r\n              top: `${top + y * image.height}px`,\r\n              color: isSelected ? 'rgb(61, 161, 143)' : 'rgb(37, 247, 209)',\r\n              transform: `translateX(-50%) translateY(-50%) ${\r\n                isSelected ? 'scale(1.3)' : 'scale(1)'\r\n              }`,\r\n            }}\r\n            onClick={() => onPinClick(pinId)}\r\n            ref={refCallback}\r\n          />\r\n        </React.Fragment>\r\n      );\r\n    });\r\n\r\n  const imageCallback = imageEl => {\r\n    if (imageEl && imageEl !== image) {\r\n      setImage(imageEl);\r\n    }\r\n  };\r\n\r\n  const displayData = !loading && !error;\r\n\r\n  // const\r\n  // const\r\n  // image.width;\r\n  // image.height;\r\n  // if (scre)\r\n  // if (image.natural)\r\n  // image.naturalWidth;\r\n  // console.log(screenDimensions, image);\r\n  // let imageSizing = {};\r\n  // if (image && screenDimensions) {\r\n  //   const imageRatio = image.naturalWidth / image.naturalHeight;\r\n  //   const screenRatio = screenDimensions.width / screenDimensions.height;\r\n  //   if (imageRatio > screenRatio) {\r\n  //     imageSizing = { width: '100%' };\r\n  //   } else {\r\n  //     imageSizing = { height: '100%' };\r\n  //   }\r\n  // }\r\n  // console.log(screenDimensions, imageSizing);\r\n\r\n  /*\r\n            <ToggleButton value=\"left\" aria-label=\"left aligned\">\r\n            <FormatAlignLeftIcon />\r\n          </ToggleButton>\r\n          <ToggleButton value=\"center\" aria-label=\"centered\">\r\n            <FormatAlignCenterIcon />\r\n          </ToggleButton>\r\n          <ToggleButton value=\"right\" aria-label=\"right aligned\">\r\n            <FormatAlignRightIcon />\r\n          </ToggleButton>\r\n          <ToggleButton value=\"justify\" aria-label=\"justified\" disabled>\r\n            <FormatAlignJustifyIcon />\r\n          </ToggleButton>\r\n  */\r\n\r\n  // const pageButtons = [];\r\n  const pageButtons = maps.map(({ name, _id }) => {\r\n    return (\r\n      <ToggleButton key={_id} value={_id}>\r\n        {name}\r\n      </ToggleButton>\r\n    );\r\n  });\r\n  const handleMapChange = (e, id) => {\r\n    console.log(id);\r\n    history.push(`/maps/${id}/view`);\r\n  };\r\n\r\n  const pinData = pins[selectedPin];\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        {/* <div className=\"metadata-section\">{displayData && mapName}</div> */}\r\n        {displayData && (\r\n          <>\r\n            <div className=\"header\">\r\n              <ToggleButtonGroup\r\n                value={mapId}\r\n                exclusive\r\n                onChange={handleMapChange}\r\n                style={{ display: 'block', marginBottom: '8px' }}\r\n              >\r\n                {pageButtons}\r\n              </ToggleButtonGroup>\r\n              Tap on an item to learn more about it.\r\n            </div>\r\n            <div className=\"content\">\r\n              <div className=\"image-wrapper\">\r\n                {renderPins()}\r\n                <img\r\n                  src={imageURL}\r\n                  className=\"App-logo\"\r\n                  alt=\"logo\"\r\n                  ref={imageCallback}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"footer\">\r\n              <PinCard pin={pinData} onClose={() => setSelectedPin()} />\r\n            </div>\r\n          </>\r\n        )}\r\n        {loading && <CircularProgress />}\r\n        {error && <p>Could not load the requested map!</p>}\r\n      </header>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Viewer;\r\n\r\nconst PinCard = ({ pin, onClose }) => {\r\n  const { title, description } = pin || {};\r\n\r\n  return (\r\n    <Card\r\n      className=\"description-card\"\r\n      style={!pin ? { opacity: 0 } : { opacity: 1 }}\r\n    >\r\n      <CardHeader\r\n        title={<h5 className=\"desc-header\">{title}</h5>}\r\n        action={\r\n          <IconButton onClick={onClose}>\r\n            <CloseIcon />\r\n          </IconButton>\r\n        }\r\n      />\r\n      <CardContent>\r\n        <p className=\"desc-body\">{description}</p>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n","import './App.css';\nimport React from 'react';\nimport { Route, Redirect, Switch, HashRouter } from 'react-router-dom';\nimport Editor from './Editor';\nimport Home from './Home';\nimport Viewer from './Viewer';\n\nconst App = () => {\n  return (\n    <HashRouter basename={'/'}>\n      <Switch>\n        <Route exact path={'/'}>\n          <Home />\n        </Route>\n        <Route path={'/maps/:mapId/view'}>\n          <Viewer />\n        </Route>\n        <Route path={'/maps/:mapId'}>\n          <Editor />\n        </Route>\n        <Redirect to={'/'} />\n      </Switch>\n    </HashRouter>\n  );\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}
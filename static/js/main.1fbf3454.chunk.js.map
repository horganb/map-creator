{"version":3,"sources":["Home.js","usePersistedState.js","Editor.js","Viewer.js","App.js","reportWebVitals.js","index.js"],"names":["mapsUrl","initialMapData","name","image","url","pins","Home","useState","maps","setMaps","history","useHistory","useEffect","axios","get","then","data","catch","e","console","error","goToMap","mapId","push","mapLinks","map","_id","Button","className","variant","onClick","color","post","usePersistedState","defaultValue","path","value","setValue","useParams","updateMap","updates","method","UpdateMethods","SET","updateObject","put","newValue","persist","UNSET","Editor","imageURL","setImageURL","mapName","setMapName","setPins","selectedPin","setSelectedPin","loading","setLoading","setError","setImage","pinRefs","useRef","displayData","pinData","TextField","label","onChange","target","CircularProgress","Object","keys","pinId","x","y","isSelected","style","left","top","transform","onPinClick","onContextMenu","preventDefault","otherPins","onPinRightClick","ref","el","current","src","rect","getBoundingClientRect","log","window","scrollY","scrollX","getPosition","relativeX","pageX","relativeY","pageY","xFraction","width","yFraction","height","id","generateId","addPin","alt","imageEl","pin","onClose","setPin","newData","PinCard","title","description","Card","CardHeader","action","IconButton","CardContent","multiline","rows","Viewer","innerHeight","innerWidth","setScreenDimensions","handleResize","addEventListener","removeEventListener","Fragment","opacity","App","basename","exact","to","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.1fbf3454.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { Button } from '@material-ui/core';\r\n\r\n// export const mapsUrl = 'http://localhost:3000';\r\n// export const mapsUrl = 'http://192.168.37.94:3000';\r\nexport const mapsUrl = 'https://map-creator-backend.herokuapp.com';\r\n\r\nconst initialMapData = {\r\n  name: 'Untitled Map',\r\n  image: {\r\n    url: 'https://cdn.pixabay.com/photo/2015/04/23/22/00/tree-736885__480.jpg',\r\n  },\r\n  pins: {},\r\n};\r\n\r\nconst Home = () => {\r\n  const [maps, setMaps] = useState([]);\r\n  const history = useHistory();\r\n\r\n  // On initial load, load the list of maps.\r\n  useEffect(() => {\r\n    axios\r\n      .get(`${mapsUrl}/maps`)\r\n      .then(({ data }) => {\r\n        setMaps(data);\r\n      })\r\n      .catch(e => {\r\n        console.error(e);\r\n      });\r\n  }, []);\r\n\r\n  const goToMap = mapId => {\r\n    history.push(`/maps/${mapId}`);\r\n  };\r\n\r\n  const mapLinks = maps.map(({ name, _id }) => {\r\n    return (\r\n      <Button\r\n        className=\"map-button\"\r\n        key={_id}\r\n        variant=\"contained\"\r\n        onClick={() => goToMap(_id)}\r\n      >\r\n        {name}\r\n      </Button>\r\n    );\r\n  });\r\n\r\n  const newMap = () => {\r\n    axios\r\n      .post(`${mapsUrl}/maps`, initialMapData)\r\n      .then(({ data }) => {\r\n        goToMap(data);\r\n      })\r\n      .catch(e => {\r\n        console.error(e);\r\n      });\r\n  };\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        <Button\r\n          className=\"map-button\"\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          onClick={newMap}\r\n        >\r\n          Create New\r\n        </Button>\r\n        {mapLinks}\r\n      </header>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n","import { useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { mapsUrl } from './Home';\r\n\r\nconst usePersistedState = (defaultValue, path) => {\r\n  const [value, setValue] = useState(defaultValue);\r\n  const { mapId } = useParams();\r\n\r\n  const updateMap = (updates, method = UpdateMethods.SET) => {\r\n    const updateObject = {\r\n      [method]: updates,\r\n    };\r\n    axios\r\n      .put(`${mapsUrl}/maps/${mapId}`, updateObject)\r\n      .then(() => {})\r\n      .catch(e => {\r\n        console.error(e);\r\n      });\r\n  };\r\n\r\n  const updateValue = (newValue, persist = true) => {\r\n    setValue(newValue);\r\n    if (persist) {\r\n      updateMap({\r\n        [path]: newValue,\r\n      });\r\n    }\r\n  };\r\n\r\n  return [value, updateValue];\r\n};\r\n\r\nexport default usePersistedState;\r\n\r\nconst UpdateMethods = {\r\n  SET: '$set',\r\n  UNSET: '$unset',\r\n};\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { useParams, useHistory } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { mapsUrl } from './Home';\r\nimport {\r\n  Button,\r\n  TextField,\r\n  CircularProgress,\r\n  Card,\r\n  CardHeader,\r\n  CardContent,\r\n  IconButton,\r\n  Popper,\r\n  Fade,\r\n} from '@material-ui/core';\r\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport { v4 as generateId } from 'uuid';\r\nimport usePersistedState from './usePersistedState';\r\n\r\nconst Editor = () => {\r\n  const { mapId } = useParams();\r\n  const history = useHistory();\r\n\r\n  const [imageURL, setImageURL] = usePersistedState('', 'image.url');\r\n  const [mapName, setMapName] = usePersistedState('', 'name');\r\n  const [pins, setPins] = usePersistedState({}, 'pins');\r\n\r\n  const [selectedPin, setSelectedPin] = useState();\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(false);\r\n  const [image, setImage] = useState();\r\n\r\n  const pinRefs = useRef({});\r\n\r\n  // When map is changed, load in the data\r\n  useEffect(() => {\r\n    if (mapId) {\r\n      setLoading(true);\r\n      axios\r\n        .get(`${mapsUrl}/maps/${mapId}`)\r\n        .then(({ data }) => {\r\n          setError(false);\r\n          const { name, image, pins } = data;\r\n          setImageURL(image.url, false);\r\n          setMapName(name, false);\r\n          setPins(pins, false);\r\n        })\r\n        .catch(e => {\r\n          console.error(e);\r\n          setError(true);\r\n        })\r\n        .then(() => {\r\n          setLoading(false);\r\n        });\r\n    }\r\n  }, [mapId]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const goHome = () => {\r\n    history.push('/');\r\n  };\r\n\r\n  const getPosition = el => {\r\n    const rect = el.getBoundingClientRect();\r\n    console.log('top', rect.top, 'scroll', window.scrollY);\r\n    return {\r\n      left: rect.left + window.scrollX,\r\n      top: rect.top + window.scrollY,\r\n    };\r\n  };\r\n\r\n  const addPin = (x, y) => {\r\n    const id = generateId();\r\n    setPins({\r\n      ...pins,\r\n      [id]: { x, y },\r\n    });\r\n  };\r\n\r\n  const onImageClick = e => {\r\n    const { left, top } = getPosition(image);\r\n    const relativeX = e.pageX - left;\r\n    const relativeY = e.pageY - top;\r\n    // console.log(left, top);\r\n    const xFraction = relativeX / image.width;\r\n    const yFraction = relativeY / image.height;\r\n    console.log(e.pageY, top);\r\n    addPin(xFraction, yFraction);\r\n  };\r\n\r\n  const onPinClick = pinId => {\r\n    setSelectedPin(pinId === selectedPin ? null : pinId);\r\n  };\r\n\r\n  const onPinRightClick = (pinId, e) => {\r\n    e.preventDefault();\r\n    const { [pinId]: _, ...otherPins } = pins;\r\n    setPins(otherPins);\r\n    setSelectedPin();\r\n  };\r\n\r\n  const renderPins = () =>\r\n    image &&\r\n    Object.keys(pins).map(pinId => {\r\n      const pinData = pins[pinId];\r\n      if (!pinData) return undefined;\r\n      const { x, y } = pinData;\r\n      const isSelected = selectedPin === pinId;\r\n\r\n      const refCallback = el => {\r\n        if (pinRefs?.current) {\r\n          pinRefs.current[pinId] = el;\r\n        }\r\n      };\r\n      // console.log('put at', y);\r\n      return (\r\n        <AddCircleIcon\r\n          className=\"pin\"\r\n          key={pinId}\r\n          style={{\r\n            left: `${x * 100}%`,\r\n            top: `${y * 100}%`,\r\n            color: isSelected ? 'rgb(61, 161, 143)' : 'rgb(37, 247, 209)',\r\n            transform: `translateX(-50%) translateY(-50%)${\r\n              isSelected ? 'scale(2)' : ''\r\n            }`,\r\n          }}\r\n          onClick={() => onPinClick(pinId)}\r\n          onContextMenu={e => onPinRightClick(pinId, e)}\r\n          ref={refCallback}\r\n        />\r\n      );\r\n    });\r\n\r\n  const imageCallback = imageEl => {\r\n    if (imageEl && imageEl !== image) {\r\n      setImage(imageEl);\r\n    }\r\n  };\r\n\r\n  const displayData = !loading && !error;\r\n\r\n  const pinData = pins[selectedPin];\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        <div className=\"header\">\r\n          <Button\r\n            className=\"return-home\"\r\n            variant=\"contained\"\r\n            color=\"secondary\"\r\n            onClick={goHome}\r\n          >\r\n            Back to Home\r\n          </Button>\r\n          {displayData && (\r\n            <>\r\n              <br />\r\n              <TextField\r\n                className=\"map-name\"\r\n                label=\"Map Name\"\r\n                value={mapName}\r\n                onChange={e => setMapName(e.target.value)}\r\n                variant=\"outlined\"\r\n              />\r\n              <br />\r\n              <TextField\r\n                className=\"image-url\"\r\n                label=\"Image URL\"\r\n                value={imageURL}\r\n                onChange={e => setImageURL(e.target.value)}\r\n                variant=\"filled\"\r\n              />\r\n            </>\r\n          )}\r\n        </div>\r\n        <div className=\"content\">\r\n          {loading && <CircularProgress />}\r\n          <div className=\"image-wrapper\">\r\n            {renderPins()}\r\n            <img\r\n              src={imageURL}\r\n              onClick={onImageClick}\r\n              className=\"App-logo\"\r\n              alt=\"logo\"\r\n              ref={imageCallback}\r\n            />\r\n          </div>\r\n        </div>\r\n        <div className=\"footer\">\r\n          {pinData && (\r\n            <PinCard\r\n              pin={pinData}\r\n              onClose={() => setSelectedPin()}\r\n              setPin={newData => {\r\n                setPins({\r\n                  ...pins,\r\n                  [selectedPin]: newData,\r\n                });\r\n              }}\r\n            />\r\n          )}\r\n        </div>\r\n        {error && <p>Could not load the requested map!</p>}\r\n      </header>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Editor;\r\n\r\nconst PinCard = ({ pin, setPin, onClose }) => {\r\n  const { title, description } = pin;\r\n\r\n  return (\r\n    <Card className=\"description-card\">\r\n      <CardHeader\r\n        title={\r\n          <TextField\r\n            className=\"title-field\"\r\n            label=\"Item Title\"\r\n            value={title}\r\n            onChange={e => setPin({ ...pin, title: e.target.value })}\r\n          />\r\n        }\r\n        action={\r\n          <IconButton onClick={onClose}>\r\n            <CloseIcon />\r\n          </IconButton>\r\n        }\r\n      />\r\n      <CardContent>\r\n        <TextField\r\n          className=\"body-field\"\r\n          label=\"Item Description\"\r\n          value={description}\r\n          onChange={e => setPin({ ...pin, description: e.target.value })}\r\n          variant=\"outlined\"\r\n          multiline\r\n          rows={3}\r\n        />\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { mapsUrl } from './Home';\r\nimport {\r\n  CircularProgress,\r\n  Card,\r\n  CardHeader,\r\n  CardContent,\r\n  IconButton,\r\n  Popper,\r\n  Fade,\r\n} from '@material-ui/core';\r\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport usePersistedState from './usePersistedState';\r\n\r\nconst Viewer = () => {\r\n  const { mapId } = useParams();\r\n\r\n  const [imageURL, setImageURL] = usePersistedState('', 'image.url');\r\n  const [mapName, setMapName] = usePersistedState('', 'name');\r\n  const [pins, setPins] = usePersistedState({}, 'pins');\r\n\r\n  const [selectedPin, setSelectedPin] = useState();\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(false);\r\n  const [image, setImage] = useState();\r\n  const [screenDimensions, setScreenDimensions] = useState({\r\n    height: window.innerHeight,\r\n    width: window.innerWidth,\r\n  });\r\n\r\n  const pinRefs = useRef({});\r\n\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      setScreenDimensions({\r\n        height: window.innerHeight,\r\n        width: window.innerWidth,\r\n      });\r\n    };\r\n\r\n    window.addEventListener('resize', handleResize);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', handleResize);\r\n    };\r\n  });\r\n\r\n  // When map is changed, load in the data\r\n  useEffect(() => {\r\n    if (mapId) {\r\n      setLoading(true);\r\n      axios\r\n        .get(`${mapsUrl}/maps/${mapId}`)\r\n        .then(({ data }) => {\r\n          setError(false);\r\n          const { name, image, pins } = data;\r\n          setImageURL(image.url, false);\r\n          setMapName(name, false);\r\n          setPins(pins, false);\r\n        })\r\n        .catch(e => {\r\n          console.error(e);\r\n          setError(true);\r\n        })\r\n        .then(() => {\r\n          setLoading(false);\r\n        });\r\n    }\r\n  }, [mapId]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const onPinClick = pinId => {\r\n    setSelectedPin(pinId === selectedPin ? null : pinId);\r\n  };\r\n\r\n  const onPinRightClick = (pinId, e) => {\r\n    e.preventDefault();\r\n    const { [pinId]: _, ...otherPins } = pins;\r\n    setPins(otherPins);\r\n    setSelectedPin();\r\n  };\r\n\r\n  const renderPins = () =>\r\n    image &&\r\n    Object.keys(pins).map(pinId => {\r\n      const pinData = pins[pinId];\r\n      if (!pinData) return undefined;\r\n      const { x, y } = pinData;\r\n      const isSelected = selectedPin === pinId;\r\n\r\n      const refCallback = el => {\r\n        if (pinRefs?.current) {\r\n          pinRefs.current[pinId] = el;\r\n        }\r\n      };\r\n\r\n      return (\r\n        <React.Fragment key={pinId}>\r\n          <AddCircleIcon\r\n            className=\"pin\"\r\n            style={{\r\n              left: `${x * 100}%`,\r\n              top: `${y * 100}%`,\r\n              color: isSelected ? 'rgb(61, 161, 143)' : 'rgb(37, 247, 209)',\r\n              transform: `translateX(-50%) translateY(-50%) ${\r\n                isSelected ? 'scale(2)' : 'scale(1)'\r\n              }`,\r\n            }}\r\n            onClick={() => onPinClick(pinId)}\r\n            ref={refCallback}\r\n          />\r\n        </React.Fragment>\r\n      );\r\n    });\r\n\r\n  const imageCallback = imageEl => {\r\n    if (imageEl && imageEl !== image) {\r\n      setImage(imageEl);\r\n    }\r\n  };\r\n\r\n  const displayData = !loading && !error;\r\n\r\n  // const\r\n  // const\r\n  // image.width;\r\n  // image.height;\r\n\r\n  const pinData = pins[selectedPin];\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        {/* <div className=\"metadata-section\">{displayData && mapName}</div> */}\r\n        {displayData && (\r\n          <>\r\n            <div className=\"header\">Tap on an item to learn more about it.</div>\r\n            <div className=\"content\">\r\n              <div className=\"image-wrapper\">\r\n                {renderPins()}\r\n                <img\r\n                  src={imageURL}\r\n                  className=\"App-logo\"\r\n                  alt=\"logo\"\r\n                  ref={imageCallback}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"footer\">\r\n              <PinCard pin={pinData} onClose={() => setSelectedPin()} />\r\n            </div>\r\n          </>\r\n        )}\r\n        {loading && <CircularProgress />}\r\n        {error && <p>Could not load the requested map!</p>}\r\n      </header>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Viewer;\r\n\r\nconst PinCard = ({ pin, onClose }) => {\r\n  const { title, description } = pin || {};\r\n\r\n  return (\r\n    <Card\r\n      className=\"description-card\"\r\n      style={!pin ? { opacity: 0 } : { opacity: 1 }}\r\n    >\r\n      <CardHeader\r\n        title={<h5 className=\"desc-header\">{title}</h5>}\r\n        action={\r\n          <IconButton onClick={onClose}>\r\n            <CloseIcon />\r\n          </IconButton>\r\n        }\r\n      />\r\n      <CardContent>\r\n        <p className=\"desc-body\">{description}</p>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n","import './App.css';\nimport React from 'react';\nimport { Route, Redirect, Switch, HashRouter } from 'react-router-dom';\nimport Editor from './Editor';\nimport Home from './Home';\nimport Viewer from './Viewer';\n\nconst App = () => {\n  return (\n    <HashRouter basename={'/'}>\n      <Switch>\n        <Route exact path={'/'}>\n          <Home />\n        </Route>\n        <Route path={'/maps/:mapId/view'}>\n          <Viewer />\n        </Route>\n        <Route path={'/maps/:mapId'}>\n          <Editor />\n        </Route>\n        <Redirect to={'/'} />\n      </Switch>\n    </HashRouter>\n  );\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}